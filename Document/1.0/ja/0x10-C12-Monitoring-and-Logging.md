# C12 監視、ログ記録、異常検出 (Monitoring, Logging & Anomaly Detection)

## 管理目標

このセクションでは、モデルやその他の AI コンポーネントが認識、実行、返却する内容についてリアルタイムかつフォレンジックな可視性を実現し、脅威を検出、トリアージ、学習するための要件を示します。

## C12.1 リクエストとレスポンスのログ記録 (Request & Response Logging)

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.1.1** | **検証:** すべてのユーザープロンプトとモデルレスポンスは、適切なメタデータ (タイムスタンプ、ユーザー ID、セッション ID、モデルバージョン) とともにログ記録されている。 | 1 | D/V |
| **12.1.2** | **検証:** ログは、適切な保持ポリシーとバックアップ手順で、安全でアクセス制御されたリポジトリに保存されている。 | 1 | D/V |
| **12.1.3** | **検証:** ログストレージシステムは、ログに含まれる機密情報を保護するために、保存時および転送時の暗号化を実装している。 | 1 | D/V |
| **12.1.4** | **検証:** プロンプトと出力内の機密データは、PII、クレデンシャル、プロプライエタリ情報に対する構成可能な編集ルールで、ログ記録前に自動的に編集またはマスクされている。 | 1 | D/V |
| **12.1.5** | **検証:** ポリシー決定と安全フィルタリングアクションは、コンテンツモデレーションシステムの監査とデバッグを可能にするために、十分な詳細でログ記録されている。 | 2 | D/V |
| **12.1.6** | **検証:** ログの完全性は、暗号署名や書き込み専用ストレージなどによって、保護されている。 | 2 | D/V |

---

## C12.2 不正使用の検出と警告 (Abuse Detection and Alerting)

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.2.1** | **検証:** システムは、シグネチャベースの検出を使用して、既知のジェイルブレイクパターン、プロンプトインジェクションの試み、敵対的入力を検出し、警告している。 | 1 | D/V |
| **12.2.2** | **検証:** システムは、標準のログ形式とプロトコルを使用して、既存のセキュリティ情報およびイベント管理 (SIEM) プラットフォームと統合している。 | 1 | D/V |
| **12.2.3** | **検証:** 強化されたセキュリティイベントは、モデル識別子、信頼スコア、安全フィルタの決定などの AI 固有のコンテキストを含んでいる。 | 2 | D/V |
| **12.2.4** | **検証:** 行動異常検出は、異常な会話パターン、過度の再試行、体系的な調査行動を識別している。 | 2 | D/V |
| **12.2.5** | **検証:** リアルタイム警告メカニズムは、潜在的なポリシー違反や攻撃の試みが検出されると、セキュリティチームに通知している。 | 2 | D/V |
| **12.2.6** | **検証:** カスタムルールは、協調的なジェイルブレイクの試み、プロンプトインジェクションキャンペーン、モデル抽出攻撃などの AI 固有の脅威パターンを検出するために、含んでいる。 | 2 | D/V |
| **12.2.7** | **検証:** 自動インシデント対応ワークフローは侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重大なセキュリティイベントをエスカレートできる。 | 3 | D/V |

---

## C12.3 モデルドリフトの検出 (Model Drift Detection)

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.3.1** | **検証:** システムは、モデルのバージョンや期間全体にわたって、正確性、信頼スコア、レイテンシ、エラー率などの基本的なパフォーマンスメトリクスを追跡している。 | 1 | D/V |
| **12.3.2** | **検証:** 自動警告は、パフォーマンスメトリクスが事前定義された低下閾値を超えた場合や、ベースラインから大幅に逸脱した場合に、トリガーしている。 | 2 | D/V |
| **12.3.3** | **検証:** ハルシネーション検出モニターは、モデル出力が事実上不正確な情報、一貫性のない情報、捏造された情報を含む場合に、インスタンスを識別してフラグ付けしている。 | 2 | D/V |

---

## C12.4 パフォーマンスと動作のテレメトリ (Performance & Behavior Telemetry)

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.4.1** | **検証:** リクエストのレイテンシ、トークン消費量、メモリ使用量、スループットなどの運用メトリクスは継続的に収集および監視されている。 | 1 | D/V |
| **12.4.2** | **検証:** 成功率と失敗率はエラーの種類とその根本原因の分類で追跡されている。 | 1 | D/V |
| **12.4.3** | **検証:** リソース利用率の監視は、GPU/CPU 使用率、メモリ消費量、ストレージ要件を含んでおり、閾値違反でアラートしている。 | 2 | D/V |

---

## C12.5 AI インシデント対応の計画と実行 (AI Incident Response Planning & Execution)

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.5.1** | **検証:** インシデント対応計画は、モデル侵害、データポイズニング、敵対的攻撃などの AI 関連のセキュリティイベントに特に対処している。 | 1 | D/V |
| **12.5.2** | **検証:** インシデント対応チームは、モデルの動作と攻撃ベクトルを調査するために、AI 固有のフォレンジックツールと専門知識にアクセスしている。 | 2 | D/V |
| **12.5.3** | **検証:** インシデント後の分析は、モデルの再トレーニングの考慮、安全フィルタの更新、学んだ教訓のセキュリティコントロールへの統合を含んでいる。 | 3 | D/V |

---

## C12.6 AI パフォーマンス低下の検出 (AI Performance Degradation Detection)

AI モデルのパフォーマンスと品質の低下を時間の経過とともに監視および検出します。

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.6.1** | **検証:** モデルの正確性、適合率、再現率、F1 スコアは継続的に監視され、ベースライン閾値と比較されている。 | 1 | D/V |
| **12.6.2** | **検証:** データドリフト検出は、モデルのパフォーマンスに影響を及ぼす可能性のある入力分布の変化を監視している。 | 1 | D/V |
| **12.6.3** | **検証:** コンセプトドリフト検出は、入力と期待される出力の間の関係の変化を識別している。 | 2 | D/V |
| **12.6.4** | **検証:** パフォーマンスの低下は自動アラートをトリガーし、モデルの再トレーニングまたは置換ワークフローを開始している。 | 2 | D/V |
| **12.6.5** | **検証:** 低下の根本原因分析は、パフォーマンスの下落とデータの変更、インフラストラクチャの問題、外部要因との相関を調べている。 | 3 | V |

---

## C12.7 DAG 視覚化とワークフローセキュリティ (DAG Visualization & Workflow Security)

ワークフロー視覚化システムを情報漏洩や改竄攻撃から保護します。

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.7.1** | **検証:** DAG 視覚化データは、保存または転送前に機密情報を削除するために、サニタイズされている。 | 1 | D/V |
| **12.7.2** | **検証:** ワークフロー視覚化アクセス制御は、認可されたユーザーのみがエージェントの決定パスと推論トレースを閲覧できるようにしている。 | 1 | D/V |
| **12.7.3** | **検証:** DAG データの完全性は暗号署名と改竄防止ストレージメカニズムを通じて保護されている。 | 2 | D/V |
| **12.7.4** | **検証:** ワークフロー視覚化システムは、細工されたノードやエッジデータを通じたインジェクション攻撃を防ぐために、入力バリデーションを実装している。 | 2 | D/V |
| **12.7.5** | **検証:** リアルタイム DAG 更新はレート制限されており、視覚化システムに対するサービス拒否攻撃を防ぐために検証されている。 | 3 | D/V |

---

## C12.8 プロアクティブなセキュリティ動作監視 (Proactive Security Behavior Monitoring)

Detection and prevention of security threats through proactive agent behavior analysis.

| # | 説明 | レベル | ロール |
|:--------:|---------------------------------------------------------------------------------------------------------------------|:---:|:---:|
| **12.8.1** | **Verify that** proactive agent behaviors are security-validated before execution with risk assessment integration. | 1 | D/V |
| **12.8.2** | **Verify that** autonomous initiative triggers include security context evaluation and threat landscape assessment. | 2 | D/V |
| **12.8.3** | **Verify that** proactive behavior patterns are analyzed for potential security implications and unintended consequences. | 2 | D/V |
| **12.8.4** | **Verify that** security-critical proactive actions require explicit approval chains with audit trails. | 3 | D/V |
| **12.8.5** | **Verify that** behavioral anomaly detection identifies deviations in proactive agent patterns that may indicate compromise. | 3 | D/V |

---

## 参考情報

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
